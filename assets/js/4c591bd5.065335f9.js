"use strict";(self.webpackChunkredis_developer_hub=self.webpackChunkredis_developer_hub||[]).push([[6779,5653,7644,6045,8454],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>u});var n=r(67294);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var c=n.createContext({}),d=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},m=function(e){var t=d(e.components);return n.createElement(c.Provider,{value:t},e.children)},l={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,s=e.mdxType,i=e.originalType,c=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),p=d(r),u=s,h=p["".concat(c,".").concat(u)]||p[u]||l[u]||i;return r?n.createElement(h,a(a({ref:t},m),{},{components:r})):n.createElement(h,a({ref:t},m))}));function u(e,t){var r=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var i=r.length,a=new Array(i);a[0]=p;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:s,a[1]=o;for(var d=2;d<i;d++)a[d]=r[d];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},50358:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(67294),s=r(52263);const i="authorByline_VoxI",a="authorLabel_a70t",o="authorProfileImage_URwT";const c=function(e){let{frontMatter:t}=e;const{siteConfig:r}=(0,s.Z)(),c=r.customFields.authors;return n.createElement(n.Fragment,null,t.authors&&n.createElement("div",{className:"docAuthors"},n.createElement("hr",null),t.authors.map((e=>n.createElement("div",{key:e,className:i},n.createElement("img",{className:o,src:`/img/${c[e].image?c[e].image:"default_author_profile_pic.png"}`,alt:`Profile picture for ${c[e].name}`}),n.createElement("div",null,n.createElement("div",{className:a},"Author:"),n.createElement("div",null,n.createElement("a",{href:c[e].link,target:"_blank"},c[e].name),", ",c[e].title))))),n.createElement("hr",null)))}},34045:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var n=r(87462),s=(r(67294),r(3905));const i={},a=void 0,o={unversionedId:"howtos/solutions/microservices/common-data/microservices-arch-with-redis",id:"howtos/solutions/microservices/common-data/microservices-arch-with-redis",title:"microservices-arch-with-redis",description:"The e-commerce microservices application discussed in the rest of this tutorial uses the following architecture:",source:"@site/docs/howtos/solutions/microservices/common-data/microservices-arch-with-redis.mdx",sourceDirName:"howtos/solutions/microservices/common-data",slug:"/howtos/solutions/microservices/common-data/microservices-arch-with-redis",permalink:"/howtos/solutions/microservices/common-data/microservices-arch-with-redis",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/microservices/common-data/microservices-arch-with-redis.mdx",tags:[],version:"current",lastUpdatedAt:1679652546,formattedLastUpdatedAt:"Mar 24, 2023",frontMatter:{}},c={},d=[],m={toc:d};function l(e){let{components:t,...r}=e;return(0,s.kt)("wrapper",(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"The e-commerce microservices application discussed in the rest of this tutorial uses the following architecture:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"products service"),": handles querying products from the database and returning them to the frontend"),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"orders service"),": handles validating and creating orders"),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"order history service"),": handles querying a customer's order history"),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"payments service"),": handles processing orders for payment"),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"digital identity service"),": handles storing digital identity and calculating identity score"),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"api gateway"),": unifies services under a single endpoint"),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"mongodb"),": serves as the primary database, storing orders, order history, products, etc."),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("inlineCode",{parentName:"li"},"redis"),": serves as the stream processor and caching database")))}l.isMDXComponent=!0},4975:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var n=r(87462),s=(r(67294),r(3905));const i={},a=void 0,o={unversionedId:"howtos/solutions/microservices/common-data/microservices-ecommerce",id:"howtos/solutions/microservices/common-data/microservices-ecommerce",title:"microservices-ecommerce",description:"The e-commerce microservices application consists of a frontend, built using Next.js with TailwindCSS. The application backend uses Node.js. The data is stored in MongoDB and Redis. Below you will find screenshots of the frontend of the e-commerce app:",source:"@site/docs/howtos/solutions/microservices/common-data/microservices-ecommerce.mdx",sourceDirName:"howtos/solutions/microservices/common-data",slug:"/howtos/solutions/microservices/common-data/microservices-ecommerce",permalink:"/howtos/solutions/microservices/common-data/microservices-ecommerce",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/microservices/common-data/microservices-ecommerce.mdx",tags:[],version:"current",lastUpdatedAt:1680952345,formattedLastUpdatedAt:"Apr 8, 2023",frontMatter:{}},c={},d=[],m={toc:d};function l(e){let{components:t,...i}=e;return(0,s.kt)("wrapper",(0,n.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"The e-commerce microservices application consists of a frontend, built using ",(0,s.kt)("a",{parentName:"p",href:"https://nextjs.org/"},"Next.js")," with ",(0,s.kt)("a",{parentName:"p",href:"https://tailwindcss.com/"},"TailwindCSS"),". The application backend uses ",(0,s.kt)("a",{parentName:"p",href:"https://nodejs.org"},"Node.js"),". The data is stored in ",(0,s.kt)("a",{parentName:"p",href:"https://www.mongodb.com/"},"MongoDB")," and ",(0,s.kt)("a",{parentName:"p",href:"https://redis.com/try-free/"},"Redis"),". Below you will find screenshots of the frontend of the e-commerce app:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"Dashboard"),": Shows the list of products with search functionality"),(0,s.kt)("p",{parentName:"li"},(0,s.kt)("img",{alt:"redis microservices e-commerce app frontend products page",src:r(89628).Z,width:"2475",height:"1873"}))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"Shopping Cart"),': Add products to the cart, then check out using the "Buy Now" button\n',(0,s.kt)("img",{alt:"redis microservices e-commerce app frontend shopping cart",src:r(70114).Z,width:"2772",height:"1942"}))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"Order history"),": Once an order is placed, the ",(0,s.kt)("inlineCode",{parentName:"p"},"Orders")," link in the top navigation bar shows the order status and history"),(0,s.kt)("p",{parentName:"li"},(0,s.kt)("img",{alt:"redis microservices e-commerce app frontend order history page",src:r(61032).Z,width:"2511",height:"1351"})))))}l.isMDXComponent=!0},31788:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var n=r(87462),s=(r(67294),r(3905));const i={},a=void 0,o={unversionedId:"howtos/solutions/microservices/common-data/microservices-source-code-tip",id:"howtos/solutions/microservices/common-data/microservices-source-code-tip",title:"microservices-source-code-tip",description:"Below is a command to the clone the source code for the application used in this tutorial",source:"@site/docs/howtos/solutions/microservices/common-data/microservices-source-code-tip.mdx",sourceDirName:"howtos/solutions/microservices/common-data",slug:"/howtos/solutions/microservices/common-data/microservices-source-code-tip",permalink:"/howtos/solutions/microservices/common-data/microservices-source-code-tip",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/microservices/common-data/microservices-source-code-tip.mdx",tags:[],version:"current",lastUpdatedAt:1679343780,formattedLastUpdatedAt:"Mar 20, 2023",frontMatter:{}},c={},d=[],m={toc:d};function l(e){let{components:t,...r}=e;return(0,s.kt)("wrapper",(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("admonition",{title:"GITHUB CODE",type:"tip"},(0,s.kt)("p",{parentName:"admonition"},"Below is a command to the clone the source code for the application used in this tutorial"),(0,s.kt)("p",{parentName:"admonition"},"git clone --branch v1.0.0 ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/redis-developer/redis-microservices-ecommerce-solutions"},"https://github.com/redis-developer/redis-microservices-ecommerce-solutions"))))}l.isMDXComponent=!0},71673:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var n=r(87462),s=(r(67294),r(3905));const i={},a=void 0,o={unversionedId:"howtos/solutions/microservices/common-data/redis-enterprise",id:"howtos/solutions/microservices/common-data/redis-enterprise",title:"redis-enterprise",description:"You can use Redis Enterprise as a multi-model primary database. Redis Enterprise is a fully managed, highly available, secure, and real-time data platform. It can store data on both RAM or Flash. It also supports Active-Active (multi-zone read and write replicas) on different cloud vendors, providing extreme high availability and scalability. Active-Active offers global scalability while maintaining local speed for database reads and writes.",source:"@site/docs/howtos/solutions/microservices/common-data/redis-enterprise.mdx",sourceDirName:"howtos/solutions/microservices/common-data",slug:"/howtos/solutions/microservices/common-data/redis-enterprise",permalink:"/howtos/solutions/microservices/common-data/redis-enterprise",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/microservices/common-data/redis-enterprise.mdx",tags:[],version:"current",lastUpdatedAt:1688164724,formattedLastUpdatedAt:"Jun 30, 2023",frontMatter:{}},c={},d=[],m={toc:d};function l(e){let{components:t,...r}=e;return(0,s.kt)("wrapper",(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"You can use ",(0,s.kt)("strong",{parentName:"p"},"Redis Enterprise")," as a multi-model primary database. Redis Enterprise is a fully managed, highly available, secure, and real-time data platform. It can store data on both RAM or ",(0,s.kt)("strong",{parentName:"p"},"Flash"),". It also supports ",(0,s.kt)("strong",{parentName:"p"},"Active-Active")," (multi-zone read and write replicas) on different cloud vendors, providing extreme high availability and scalability. Active-Active offers global scalability while maintaining local speed for database reads and writes."),(0,s.kt)("p",null,"Redis Enterprise has many built-in modular capabilities, making it a unified, real-time data platform. Redis Enterprise is far more than a document database."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"JSON"),": Persists JSON documents"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Search"),": Indexes and searches JSON documents"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Probabilistic data structures"),": Provides bloom filters and other probabilistic data structures"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Time Series"),": Supports time series data structures"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Triggers and Functions"),": Syncs data to external databases via different pattern (write-behind/ write-through) or executes custom logic.")),(0,s.kt)("p",null,"Use ",(0,s.kt)("a",{parentName:"p",href:"https://redis.com/redis-enterprise/redis-insight/"},"RedisInsight")," to view your Redis data or to play with raw Redis commands in the workbench."),(0,s.kt)("p",null,"If you're interested in diving deeper, try ",(0,s.kt)("a",{parentName:"p",href:"https://redis.com/try-free"},"Redis Enterprise")," today for free!"))}l.isMDXComponent=!0},57013:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>m,default:()=>v,frontMatter:()=>d,metadata:()=>l,toc:()=>u});var n=r(87462),s=(r(67294),r(3905)),i=r(50358),a=r(4975),o=r(34045),c=r(31788);r(71673);const d={id:"index-solutions-interservice-communication",title:"Microservices Communication with Redis Streams",sidebar_label:"Microservices Communication with Redis Streams",slug:"/howtos/solutions/microservices/interservice-communication",authors:["prasan","will"]},m=void 0,l={unversionedId:"howtos/solutions/microservices/interservice-communication/index-solutions-interservice-communication",id:"howtos/solutions/microservices/interservice-communication/index-solutions-interservice-communication",title:"Microservices Communication with Redis Streams",description:"What is interservice communication?",source:"@site/docs/howtos/solutions/microservices/interservice-communication/index-interservice-communication.mdx",sourceDirName:"howtos/solutions/microservices/interservice-communication",slug:"/howtos/solutions/microservices/interservice-communication",permalink:"/howtos/solutions/microservices/interservice-communication",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/microservices/interservice-communication/index-interservice-communication.mdx",tags:[],version:"current",lastUpdatedAt:1680952345,formattedLastUpdatedAt:"Apr 8, 2023",frontMatter:{id:"index-solutions-interservice-communication",title:"Microservices Communication with Redis Streams",sidebar_label:"Microservices Communication with Redis Streams",slug:"/howtos/solutions/microservices/interservice-communication",authors:["prasan","will"]},sidebar:"docs",previous:{title:"How to Build an E-Commerce App Using Redis with the CQRS Pattern",permalink:"/howtos/solutions/microservices/cqrs"},next:{title:"How to use Redis for Query Caching",permalink:"/howtos/solutions/microservices/caching"}},p={},u=[{value:"What is interservice communication?",id:"what-is-interservice-communication",level:2},{value:"Why you should use Redis for interservice communication",id:"why-you-should-use-redis-for-interservice-communication",level:2},{value:"Microservices architecture for an e-commerce application",id:"microservices-architecture-for-an-e-commerce-application",level:2},{value:"Using Redis for interservice communication in an event-driven architecture",id:"using-redis-for-interservice-communication-in-an-event-driven-architecture",level:2},{value:"E-commerce application frontend using Next.js and Tailwind",id:"e-commerce-application-frontend-using-nextjs-and-tailwind",level:2},{value:"Building an interservice communication application with Redis and MongoDB",id:"building-an-interservice-communication-application-with-redis-and-mongodb",level:2},{value:"Producer 1 (orders service)",id:"producer-1-orders-service",level:3},{value:"Consumer 1 (payments service)",id:"consumer-1-payments-service",level:3},{value:"Producer 2 (payments service)",id:"producer-2-payments-service",level:3},{value:"Consumer 2 (orders service)",id:"consumer-2-orders-service",level:3},{value:"Ready to use Redis for streaming?",id:"ready-to-use-redis-for-streaming",level:2},{value:"Additional resources",id:"additional-resources",level:3}],h={toc:u};function v(e){let{components:t,...m}=e;return(0,s.kt)("wrapper",(0,n.Z)({},h,m,{components:t,mdxType:"MDXLayout"}),(0,s.kt)(i.Z,{frontMatter:d,mdxType:"Authors"}),(0,s.kt)(c.default,{mdxType:"SourceCode"}),(0,s.kt)("h2",{id:"what-is-interservice-communication"},"What is interservice communication?"),(0,s.kt)("p",null,"When building a microservices application, people use a variety of options for communication between services. Among them:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("strong",{parentName:"li"},"Publish/Subscribe")," model: In the pub/sub model (fire and forget), a publisher produces messages, and subscribers that are ",(0,s.kt)("em",{parentName:"li"},"active at the time")," consume those messages. Inactive subscribers cannot receive the messages at a later point in time."),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("strong",{parentName:"li"},"Streaming"),": Most microservices applications use an event-streaming solution because of:",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Message persistence"),": Unlike the pub/sub model, messages stored in streams can be read by multiple consumers at any time; they fan out. So consumers can read messages at a later point in time, even if they were not active when the message was originally appended to the stream."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Inherent replayability"),": Even if a subscriber crashes during the message processing, it can re-read the exact same unacknowledged message from the stream. For example, say the crashed subscriber never comes back online; the consumer group feature allows consumers to process unacknowledged messages of other consumers after a specified time."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Separation of concerns"),": Producers can produce messages to stream at ",(0,s.kt)("strong",{parentName:"li"},"high speed"),' separately and consumers can process messages at their own speed separately. This separation of concerns solves both the "fast producer -> slow consumer" and "slow producer -> fast consumer" problem, allowing for the scaling of those services independently.')))),(0,s.kt)("p",null,"In an event-driven microservices architecture, you might have some services that publish an API, and other services that are simply producers and consumers of events with no external API."),(0,s.kt)("h2",{id:"why-you-should-use-redis-for-interservice-communication"},"Why you should use Redis for interservice communication"),(0,s.kt)("p",null,"Consider the following scenario: You have an e-commerce application with an architecture that is broken down into different microservices including as ",(0,s.kt)("inlineCode",{parentName:"p"},"create an order"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"create an invoice"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"process a payment"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"fulfill and order"),", and so on. Microservices allow you to separate these commands into different services to scale independently, enabling more customers to get their orders processed quickly and simultaneously, which results in a better user experience, higher sales volume, and less-cranky customer service staff."),(0,s.kt)("p",null,"When you use microservices, you need a tool for interservice communication. Initially, you might consider using a product like ",(0,s.kt)("strong",{parentName:"p"},"Kafka")," for streaming, but setting it up is rather complicated. What many people don't know about Redis is that it supports streams in the same way Kafka does. Given that you are likely already using Redis for caching, it makes sense to also use it for stream processing. To reduce the complexity of application architecture and maintenance, ",(0,s.kt)("strong",{parentName:"p"},"Redis")," is a great option for interservice communication. Here we break down the process of using Redis with streams for interservice communication."),(0,s.kt)("h2",{id:"microservices-architecture-for-an-e-commerce-application"},"Microservices architecture for an e-commerce application"),(0,s.kt)(o.default,{mdxType:"MicroservicesArchitectureWithRedis"}),(0,s.kt)("p",null,"This diagram illustrates how Redis Streams is used as the message broker between the ",(0,s.kt)("inlineCode",{parentName:"p"},"orders service")," and the ",(0,s.kt)("inlineCode",{parentName:"p"},"payments service"),":"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Microservices interservice communication with Redis streams message broker",src:r(17931).Z,width:"1757",height:"777"})),(0,s.kt)("admonition",{type:"tip"},(0,s.kt)("p",{parentName:"admonition"},"Redis Streams is more cost-effective than using Kafka or other similar technologies.\nWith sub-millisecond latency and a lightweight Streams log data structure, Redis is easier to deploy, develop, and operate.")),(0,s.kt)("h2",{id:"using-redis-for-interservice-communication-in-an-event-driven-architecture"},"Using Redis for interservice communication in an event-driven architecture"),(0,s.kt)("p",null,"The following event flow diagram illustrates how the ",(0,s.kt)("inlineCode",{parentName:"p"},"orders service")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"payments service")," communicate through Redis with streams:"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Microservices streaming with Redis event flow diagram",src:r(66478).Z,width:"1161",height:"1235"})),(0,s.kt)("p",null,"Let's outline the streams and events used below:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"The ",(0,s.kt)("inlineCode",{parentName:"p"},"orders service")," inserts order data into the database."),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-json"},'//sample order data\n{\n  "orderId": "01GTP3K2TZQQCQ0T2G43DSSMTD",\n  "products": [\n    {\n      "productId": 11000,\n      "qty": 3,\n      "productPrice": 3995,\n      "productData": {\n        "productDisplayName": "Puma Men Slick 3HD Yellow Black Watches",\n        "variantName": "Slick 3HD Yellow",\n        "brandName": "Puma",\n        "ageGroup": "Adults-Men",\n        "gender": "Men"\n        //...\n      }\n    },\n    {\n      "productId": 11001,\n      "qty": 2,\n      "productPrice": 5450,\n      "productData": {\n        "productDisplayName": "Puma Men Top Fluctuation Red Black Watches",\n        "variantName": "Top Fluctuation Red",\n        "brandName": "Puma",\n        "ageGroup": "Adults-Men",\n        "gender": "Men"\n        //...\n      }\n    }\n  ],\n  "userId": "USR_4e7acc44-e91e-4c5c-9112-bdd99d799dd3",\n  "orderStatusCode": 1, //order created\n  "createdOn": {\n    "$date": {\n      "$numberLong": "1677926697801"\n    }\n  },\n  "createdBy": "USR_4e7acc44-e91e-4c5c-9112-bdd99d799dd3",\n  "statusCode": 1\n}\n'))),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"The ",(0,s.kt)("inlineCode",{parentName:"p"},"orders service")," also appends minimal data (orderId, orderAmount, and userId) to the ",(0,s.kt)("inlineCode",{parentName:"p"},"ORDERS_STREAM")," to signal new order creation (i.e., it acts as ",(0,s.kt)("inlineCode",{parentName:"p"},"PRODUCER")," of the ",(0,s.kt)("inlineCode",{parentName:"p"},"ORDERS_STREAM"),")."),(0,s.kt)("p",{parentName:"li"},(0,s.kt)("img",{alt:"orders-stream",src:r(72312).Z,width:"2432",height:"812"}))),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"The ",(0,s.kt)("inlineCode",{parentName:"p"},"payments service")," listens to the ",(0,s.kt)("inlineCode",{parentName:"p"},"ORDERS_STREAM")," and processes payments for new orders, then inserts payment data into the database (i.e, it acts as the ",(0,s.kt)("inlineCode",{parentName:"p"},"CONSUMER")," of the ",(0,s.kt)("inlineCode",{parentName:"p"},"ORDERS_STREAM"),")."),(0,s.kt)("pre",{parentName:"li"},(0,s.kt)("code",{parentName:"pre",className:"language-json"},'//sample payment data\n{\n  "paymentId": "6403212956a976300afbaac1",\n  "orderId": "01GTP3K2TZQQCQ0T2G43DSSMTD",\n  "orderAmount": 22885,\n  "paidAmount": 22885,\n  "orderStatusCode": 3, //payment successful\n  "userId": "USR_4e7acc44-e91e-4c5c-9112-bdd99d799dd3",\n  "createdOn": {\n    "$date": {\n      "$numberLong": "1677926697841"\n    }\n  },\n  "createdBy": "USR_4e7acc44-e91e-4c5c-9112-bdd99d799dd3",\n  "statusCode": 1\n}\n'))),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"The ",(0,s.kt)("inlineCode",{parentName:"p"},"payments service")," appends minimal data (orderId, paymentId, orderStatusCode, and userId) to the ",(0,s.kt)("inlineCode",{parentName:"p"},"PAYMENTS_STREAM")," to signal a new payment (i.e., it acts as the ",(0,s.kt)("inlineCode",{parentName:"p"},"PRODUCER")," of the ",(0,s.kt)("inlineCode",{parentName:"p"},"PAYMENTS_STREAM"),").\n",(0,s.kt)("img",{alt:"payments-stream",src:r(28929).Z,width:"2406",height:"688"}))),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"The ",(0,s.kt)("inlineCode",{parentName:"p"},"orders service")," listens to the ",(0,s.kt)("inlineCode",{parentName:"p"},"PAYMENTS_STREAM")," and updates the orderStatus and paymentId for orders in the database accordingly as the order payment is fulfilled (i.e., it acts as the ",(0,s.kt)("inlineCode",{parentName:"p"},"CONSUMER")," of the ",(0,s.kt)("inlineCode",{parentName:"p"},"PAYMENTS_STREAM"),")."))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  //order collection update\n  "orderId": "01GTP3K2TZQQCQ0T2G43DSSMTD",\n  "paymentId": "6403212956a976300afbaac1",\n  "orderStatusCode": 3 //payment success\n  //...\n}\n')),(0,s.kt)("h2",{id:"e-commerce-application-frontend-using-nextjs-and-tailwind"},"E-commerce application frontend using Next.js and Tailwind"),(0,s.kt)(a.default,{mdxType:"MicroservicesEcommerceDesign"}),(0,s.kt)(c.default,{mdxType:"SourceCode"}),(0,s.kt)("h2",{id:"building-an-interservice-communication-application-with-redis-and-mongodb"},"Building an interservice communication application with Redis and MongoDB"),(0,s.kt)("p",null,"We use Redis to broker the events sent between the ",(0,s.kt)("inlineCode",{parentName:"p"},"orders service")," and the ",(0,s.kt)("inlineCode",{parentName:"p"},"payments service"),"."),(0,s.kt)("h3",{id:"producer-1-orders-service"},"Producer 1 (orders service)"),(0,s.kt)("p",null,"Let's look at some of the code in the orders service to understand how it works:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Orders are created."),(0,s.kt)("li",{parentName:"ol"},"After order creation, the ",(0,s.kt)("inlineCode",{parentName:"li"},"orders service")," appends minimal data to the ",(0,s.kt)("inlineCode",{parentName:"li"},"ORDERS_STREAM")," to signal new order creation.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="server/src/services/orders/src/service-impl.ts"',title:'"server/src/services/orders/src/service-impl.ts"'},"const addOrderIdToStream = async (\n  orderId: string,\n  orderAmount: number,\n  userId: string,\n) => {\n  const nodeRedisClient = getNodeRedisClient();\n  if (orderId && nodeRedisClient) {\n    const streamKeyName = 'ORDERS_STREAM';\n    const entry = {\n      orderId: orderId,\n      orderAmount: orderAmount.toFixed(2),\n      userId: userId,\n    };\n    const id = '*'; //* = auto generate\n    //xAdd adds entry to specified stream\n    await nodeRedisClient.xAdd(streamKeyName, id, entry);\n  }\n};\n")),(0,s.kt)("h3",{id:"consumer-1-payments-service"},"Consumer 1 (payments service)"),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},"The ",(0,s.kt)("inlineCode",{parentName:"li"},"payments service")," listens to the ",(0,s.kt)("inlineCode",{parentName:"li"},"ORDERS_STREAM"))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="server/src/services/payments/src/service-impl.ts"',title:'"server/src/services/payments/src/service-impl.ts"'},"// Below is some code for how you would use Redis to listen for the stream events:\n\nasync function listenToStream(\n  onMessage: (message: any, messageId: string) => Promise<void>,\n) {\n  // using node-redis\n  const redis = getNodeRedisClient();\n  const streamKeyName = 'ORDERS_STREAM'; //stream name\n  const groupName = 'ORDERS_CON_GROUP'; // listening consumer group name (custom)\n  const consumerName = 'PAYMENTS_CON'; // listening consumer name (custom)\n  const readMaxCount = 100;\n\n  // Check if the stream group already exists\n  if (!(await redis.exists(streamKeyName))) {\n    const idPosition = '0'; //0 = start, $ = end or any specific id\n    await nodeRedisClient.xGroupCreate(streamKeyName, groupName, idPosition, {\n      MKSTREAM: true,\n    });\n  }\n\n  // setup a loop to listen for stream events\n  while (true) {\n    // read set of messages from different streams\n    const dataArr = await nodeRedisClient.xReadGroup(\n      commandOptions({\n        isolated: true,\n      }),\n      groupName,\n      consumerName,\n      [\n        {\n          // you can specify multiple streams in array\n          key: streamKeyName,\n          id: '>', // Next entry ID that no consumer in this group has read\n        },\n      ],\n      {\n        COUNT: readMaxCount, // Read n entries at a time\n        BLOCK: 0, // block for 0 (infinite) seconds if there are none.\n      },\n    );\n\n    for (let data of dataArr) {\n      for (let messageItem of data.messages) {\n        // process the message received (in our case, perform payment)\n        await onMessage(messageItem.message, messageItem.id);\n\n        // acknowledge individual messages after processing\n        nodeRedisClient.xAck(streamKeyName, groupName, messageItem.id);\n      }\n    }\n  }\n}\n\n// `listenToStream` listens for events and calls the `onMessage` callback to further handle the events.\nlistenToStream({\n  onMessage: processPaymentForNewOrders,\n});\n\nconst processPaymentForNewOrders: IMessageHandler = async (\n  message,\n  messageId,\n) => {\n  /*\n   message = {\n      orderId: \"\",\n      orderAmount: \"\",\n      userId: \"\",\n    }\n    */\n  // process payment for new orderId and insert \"payments\" data to database\n};\n")),(0,s.kt)("admonition",{type:"note"},(0,s.kt)("p",{parentName:"admonition"},"There are a few important things to note here:"),(0,s.kt)("ol",{parentName:"admonition"},(0,s.kt)("li",{parentName:"ol"},"Make sure the stream group doesn't exist prior to creating it."),(0,s.kt)("li",{parentName:"ol"},"Use ",(0,s.kt)("inlineCode",{parentName:"li"},"isolated: true,")," in order to use the blocking version of ",(0,s.kt)("inlineCode",{parentName:"li"},"XREADGROUP")," in ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/redis/node-redis/blob/master/docs/isolated-execution.md"},"isolated execution")," mode."),(0,s.kt)("li",{parentName:"ol"},"Acknowledge individual messages after you process them to remove the messages from the pending orders queue and to avoid processing them more than once."))),(0,s.kt)("h3",{id:"producer-2-payments-service"},"Producer 2 (payments service)"),(0,s.kt)("ol",{start:4},(0,s.kt)("li",{parentName:"ol"},"The ",(0,s.kt)("inlineCode",{parentName:"li"},"payments service")," appends minimal data to ",(0,s.kt)("inlineCode",{parentName:"li"},"PAYMENTS_STREAM")," to signal that a payment has been fulfilled.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="server/src/services/payments/src/service-impl.ts"',title:'"server/src/services/payments/src/service-impl.ts"'},"const addPaymentIdToStream = async (\n  orderId: string,\n  paymentId: string,\n  orderStatus: number,\n  userId: string,\n) => {\n  const nodeRedisClient = getNodeRedisClient();\n  if (orderId && nodeRedisClient) {\n    const streamKeyName = 'PAYMENTS_STREAM';\n    const entry = {\n      orderId: orderId,\n      paymentId: paymentId,\n      orderStatusCode: orderStatus.toString(),\n      userId: userId,\n    };\n    const id = '*'; //* = auto generate\n    //xAdd adds entry to specified stream\n    await nodeRedisClient.xAdd(streamKeyName, id, entry);\n  }\n};\n")),(0,s.kt)("h3",{id:"consumer-2-orders-service"},"Consumer 2 (orders service)"),(0,s.kt)("ol",{start:5},(0,s.kt)("li",{parentName:"ol"},"The ",(0,s.kt)("inlineCode",{parentName:"li"},"orders service")," listens to the ",(0,s.kt)("inlineCode",{parentName:"li"},"PAYMENTS_STREAM")," and updates the order when payments are fulfilled.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript",metastring:'title="server/src/services/orders/src/service-impl.ts"',title:'"server/src/services/orders/src/service-impl.ts"'},"//Below is some code for how you would use Redis to listen for the stream events:\n\nasync function listenToStream(\n  onMessage: (message: any, messageId: string) => Promise<void>,\n) {\n  // using node-redis\n  const redis = getNodeRedisClient();\n  const streamKeyName = 'PAYMENTS_STREAM'; //stream name\n  const groupName = 'PAYMENTS_CON_GROUP'; //listening consumer group name (custom)\n  const consumerName = 'ORDERS_CON'; //listening consumer name (custom)\n  const readMaxCount = 100;\n\n  // Check if the stream group already exists\n  if (!(await redis.exists(streamKeyName))) {\n    const idPosition = '0'; //0 = start, $ = end or any specific id\n    await nodeRedisClient.xGroupCreate(streamKeyName, groupName, idPosition, {\n      MKSTREAM: true,\n    });\n  }\n\n  // setup a loop to listen for stream events\n  while (true) {\n    // read set of messages from different streams\n    const dataArr = await nodeRedisClient.xReadGroup(\n      commandOptions({\n        isolated: true,\n      }),\n      groupName,\n      consumerName,\n      [\n        {\n          // you can specify multiple streams in array\n          key: streamKeyName,\n          id: '>', // Next entry ID that no consumer in this group has read\n        },\n      ],\n      {\n        COUNT: readMaxCount, // Read n entries at a time\n        BLOCK: 0, // block for 0 (infinite) seconds if there are none.\n      },\n    );\n\n    for (let data of dataArr) {\n      for (let messageItem of data.messages) {\n        //process the message received (in our case, updateOrderStatus)\n        await onMessage(messageItem.message, messageItem.id);\n\n        // acknowledge individual messages after processing\n        nodeRedisClient.xAck(streamKeyName, groupName, messageItem.id);\n      }\n    }\n  }\n}\n\n// `listenToStream` listens for events and calls the `onMessage` callback to further handle the events.\nlistenToStream({\n  onMessage: updateOrderStatus,\n});\n\nconst updateOrderStatus: IMessageHandler = async (message, messageId) => {\n  /*\n   message = {\n      orderId: \"\",\n      paymentId: \"\",\n      orderStatusCode:\"\",\n      userId: \"\",\n    }\n    */\n  // updates orderStatus and paymentId in database accordingly for the order which has fulfilled payment\n  // updateOrderStatusInRedis(orderId,paymentId,orderStatusCode,userId)\n  // updateOrderStatusInMongoDB(orderId,paymentId,orderStatusCode,userId)\n};\n")),(0,s.kt)("admonition",{type:"tip"},(0,s.kt)("p",{parentName:"admonition"},"It's a best practice to validate all incoming messages to make sure you can work with them.")),(0,s.kt)("p",null,"For the purposes of our application, we make a call to update the order status in both Redis and MongoDB in the same service (For simplicity, we are not using any synchronization technique between databases rather focusing on how the data is stored and accessed in Redis). Another common pattern is to have your services write to one database, and then separately use a CDC mechanism to update the other database. For example, you could write directly to Redis, then use ",(0,s.kt)("strong",{parentName:"p"},"RedisGears")," to handle synchronizing Redis and MongoDB in the background."),(0,s.kt)("admonition",{type:"tip"},(0,s.kt)("p",{parentName:"admonition"},"If you use ",(0,s.kt)("strong",{parentName:"p"},"Redis Enterprise"),", you will find that Redis Streams is available on the same multi-tenant data platform you already use for caching. Redis Enterprise also has high availability, message persistence, support for multiple clients, and resiliency with primary/secondary data replication\u2026 all built in.")),(0,s.kt)("h2",{id:"ready-to-use-redis-for-streaming"},"Ready to use Redis for streaming?"),(0,s.kt)("p",null,"That's all there is to it! You now know how to use Redis for streaming as both a producer and a consumer. Hopefully, you can draw some inspiration from this tutorial and apply it to your own event streaming application. For more on this topic, check out the additional resources below:"),(0,s.kt)("h3",{id:"additional-resources"},"Additional resources"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Redis Streams",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Explore streams in detail in the ",(0,s.kt)("a",{parentName:"li",href:"https://university.redis.com/courses/ru202/"},"Redis University course on Redis Streams")),(0,s.kt)("li",{parentName:"ul"},"Check out our e-book on ",(0,s.kt)("a",{parentName:"li",href:"https://redis.com/docs/understanding-streams-in-redis-and-kafka-a-visual-guide/"},"Understanding Streams in Redis and Kafka: A Visual Guide")))),(0,s.kt)("li",{parentName:"ul"},"Microservices with Redis",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/howtos/solutions/microservices/cqrs"},"CQRS")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/howtos/solutions/microservices/caching"},"Query caching")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/howtos/solutions/microservices/api-gateway-caching"},"API gateway caching")))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://www.youtube.com/c/Redisinc"},"Redis YouTube channel")),(0,s.kt)("li",{parentName:"ul"},"Clients like ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/redis/node-redis"},"Node Redis")," and ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/redis/redis-om-node"},"Redis om Node")," help you to use Redis in Node.js applications."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://redis.com/redis-enterprise/redis-insight/"},"RedisInsight")," : To view your Redis data or to play with raw Redis commands in the workbench"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://redis.com/try-free/"},"Try Redis Enterprise for free"))))}v.isMDXComponent=!0},70114:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/design-cart-2-2a3b76656f26a754bed6a6c63ad8beef.png"},89628:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/design-dashboard-6a34137ca4862561cc2f065ed55ae081.png"},61032:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/design-order-history-16fc808f70b63d91a37a3ea76baa232d.png"},72312:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/02-orders-stream-ea812c202b5cf7945c0427b6d6dcbecc.png"},28929:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/04-payments-stream-481caa686e491a6c72e80e021a20bc53.png"},66478:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/interservice-communication-event-flow-diagram-42f94a8386cd7f22a4af11e445265c63.png"},17931:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/interservice-communication-redis-streams-b2139615d30da6510e7c60f900f06b8a.png"}}]);